# ğŸš€ å®Œæ•´éƒ¨ç½²æµç¨‹ - æ™ºèƒ½ä½“æ¯”èµ›æŠ¥åå¹³å°

## ğŸ“‹ é¡¹ç›®ä¿¡æ¯

- **é¡¹ç›®åç§°**: æ™ºèƒ½ä½“æ¯”èµ›æŠ¥åå¹³å°
- **åŸŸå**: https://aigctmp.wzbc.edu.cn
- **æœåŠ¡å™¨IP**: 10.145.251.29
- **éƒ¨ç½²ç›®å½•**: /var/www/aigctmp

---

## ğŸ“¦ ç¬¬ä¸€éƒ¨åˆ†ï¼šæœ¬åœ°å‡†å¤‡ï¼ˆåœ¨å¼€å‘ç”µè„‘ä¸Šï¼‰

### æ­¥éª¤1: å®‰è£…Node.js

**æ£€æŸ¥æ˜¯å¦å·²å®‰è£…**:
```bash
node --version
# éœ€è¦ >= 18.0.0
```

**å¦‚æœæœªå®‰è£…**:
- è®¿é—® https://nodejs.org/
- ä¸‹è½½LTSç‰ˆæœ¬
- å®‰è£…å®Œæˆåé‡æ–°æ‰“å¼€ç»ˆç«¯

### æ­¥éª¤2: è·å–é¡¹ç›®ä»£ç 

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/projects/app-7z58i603if41

# æŸ¥çœ‹é¡¹ç›®æ–‡ä»¶
ls -la
```

### æ­¥éª¤3: å®‰è£…é¡¹ç›®ä¾èµ–

```bash
# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡éœ€è¦5-10åˆ†é’Ÿï¼‰
npm install

# å¦‚æœå®‰è£…å¾ˆæ…¢ï¼Œä½¿ç”¨å›½å†…é•œåƒ
npm config set registry https://registry.npmmirror.com
npm install
```

### æ­¥éª¤4: é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘.envæ–‡ä»¶
nano .env
```

`.env` æ–‡ä»¶å†…å®¹ï¼š
```bash
# æœ¬åœ°éƒ¨ç½²é…ç½®
VITE_APP_URL=https://aigctmp.wzbc.edu.cn
VITE_APP_ID=aigc_wzbc
```

ä¿å­˜æ–‡ä»¶ï¼ˆCtrl+Oï¼Œå›è½¦ï¼ŒCtrl+Xï¼‰

### æ­¥éª¤5: æ„å»ºé¡¹ç›®

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

**æ„å»ºæˆåŠŸçš„æ ‡å¿—**:
```
âœ“ 1884 modules transformed.
âœ“ built in 4.31s
```

**æ„å»ºç»“æœ**:
- ç”Ÿæˆ `dist/` ç›®å½•
- åŒ…å«æ‰€æœ‰é™æ€æ–‡ä»¶ï¼ˆHTML, CSS, JS, å›¾ç‰‡ç­‰ï¼‰

**æ£€æŸ¥æ„å»ºç»“æœ**:
```bash
# æŸ¥çœ‹distç›®å½•
ls -lh dist/

# åº”è¯¥çœ‹åˆ°:
# index.html
# assets/
# .htaccess
# ç­‰æ–‡ä»¶
```

---

## ğŸŒ ç¬¬äºŒéƒ¨åˆ†ï¼šæœåŠ¡å™¨éƒ¨ç½²ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰

### æ­¥éª¤1: è¿æ¥åˆ°æœåŠ¡å™¨

```bash
# ä»æœ¬åœ°ç”µè„‘è¿æ¥åˆ°æœåŠ¡å™¨
ssh lw@10.145.251.29

# è¾“å…¥å¯†ç åç™»å½•
```

### æ­¥éª¤2: å‡†å¤‡éƒ¨ç½²ç›®å½•

```bash
# åˆ›å»ºç½‘ç«™ç›®å½•
sudo mkdir -p /var/www/aigctmp

# è®¾ç½®æ‰€æœ‰è€…ä¸ºå½“å‰ç”¨æˆ·ï¼ˆæ–¹ä¾¿ä¸Šä¼ æ–‡ä»¶ï¼‰
sudo chown -R $USER:$USER /var/www/aigctmp
```

### æ­¥éª¤3: ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

**æ–¹å¼1: ä½¿ç”¨SCPï¼ˆæ¨èï¼‰**

åœ¨**æœ¬åœ°ç”µè„‘**ä¸Šæ‰§è¡Œï¼š
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/projects/app-7z58i603if41

# ä¸Šä¼ distç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
scp -r dist/* lw@10.145.251.29:/var/www/aigctmp/

# è¾“å…¥å¯†ç åå¼€å§‹ä¸Šä¼ 
```

**æ–¹å¼2: ä½¿ç”¨rsyncï¼ˆæ›´å¿«ï¼‰**

åœ¨**æœ¬åœ°ç”µè„‘**ä¸Šæ‰§è¡Œï¼š
```bash
# åŒæ­¥æ–‡ä»¶ï¼ˆä¼šè‡ªåŠ¨è·³è¿‡æœªä¿®æ”¹çš„æ–‡ä»¶ï¼‰
rsync -avz --delete dist/ lw@10.145.251.29:/var/www/aigctmp/
```

**æ–¹å¼3: å¦‚æœåœ¨æœåŠ¡å™¨ä¸Šç›´æ¥æ„å»º**

åœ¨**æœåŠ¡å™¨**ä¸Šæ‰§è¡Œï¼š
```bash
# å…‹éš†æˆ–ä¸Šä¼ é¡¹ç›®ä»£ç åˆ°æœåŠ¡å™¨
cd ~
# å‡è®¾é¡¹ç›®å·²ç»åœ¨ ~/projects/app-7z58i603if41

# å®‰è£…ä¾èµ–
cd ~/projects/app-7z58i603if41
npm install

# æ„å»º
npm run build

# å¤åˆ¶åˆ°éƒ¨ç½²ç›®å½•
cp -r dist/* /var/www/aigctmp/
```

### æ­¥éª¤4: è®¾ç½®æ–‡ä»¶æƒé™

åœ¨**æœåŠ¡å™¨**ä¸Šæ‰§è¡Œï¼š
```bash
# è®¾ç½®æ‰€æœ‰è€…ä¸ºApacheç”¨æˆ·
sudo chown -R www-data:www-data /var/www/aigctmp

# è®¾ç½®ç›®å½•æƒé™ä¸º755
sudo find /var/www/aigctmp -type d -exec chmod 755 {} \;

# è®¾ç½®æ–‡ä»¶æƒé™ä¸º644
sudo find /var/www/aigctmp -type f -exec chmod 644 {} \;

# éªŒè¯æƒé™
ls -la /var/www/aigctmp/
```

---

## âš™ï¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šApacheé…ç½®ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰

### æ­¥éª¤1: å®‰è£…Apacheï¼ˆå¦‚æœæœªå®‰è£…ï¼‰

```bash
# æ£€æŸ¥Apacheæ˜¯å¦å·²å®‰è£…
apache2 -v

# å¦‚æœæœªå®‰è£…ï¼Œæ‰§è¡Œå®‰è£…
sudo apt update
sudo apt install apache2 -y
```

### æ­¥éª¤2: åˆ›å»ºè™šæ‹Ÿä¸»æœºé…ç½®

```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
sudo nano /etc/apache2/sites-available/aigctmp.conf
```

**ç²˜è´´ä»¥ä¸‹é…ç½®**:
```apache
<VirtualHost *:80>
    ServerName aigctmp.wzbc.edu.cn
    DocumentRoot /var/www/aigctmp

    <Directory /var/www/aigctmp>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted

        # SPAè·¯ç”±æ”¯æŒï¼ˆé‡è¦ï¼ï¼‰
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.html$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.html [L]
    </Directory>

    # æ—¥å¿—æ–‡ä»¶
    ErrorLog ${APACHE_LOG_DIR}/aigctmp_error.log
    CustomLog ${APACHE_LOG_DIR}/aigctmp_access.log combined
</VirtualHost>
```

ä¿å­˜æ–‡ä»¶ï¼ˆCtrl+Oï¼Œå›è½¦ï¼ŒCtrl+Xï¼‰

### æ­¥éª¤3: å¯ç”¨é…ç½®å’Œå¿…è¦æ¨¡å—

```bash
# å¯ç”¨ç½‘ç«™é…ç½®
sudo a2ensite aigctmp.conf

# å¯ç”¨rewriteæ¨¡å—ï¼ˆSPAè·¯ç”±å¿…éœ€ï¼‰
sudo a2enmod rewrite

# æµ‹è¯•é…ç½®æ˜¯å¦æ­£ç¡®
sudo apache2ctl configtest

# åº”è¯¥æ˜¾ç¤º: Syntax OK
```

### æ­¥éª¤4: é‡å¯Apache

```bash
# é‡å¯Apacheä½¿é…ç½®ç”Ÿæ•ˆ
sudo systemctl restart apache2

# æ£€æŸ¥ApacheçŠ¶æ€
sudo systemctl status apache2

# åº”è¯¥æ˜¾ç¤º: active (running)
```

### æ­¥éª¤5: é…ç½®é˜²ç«å¢™ï¼ˆå¦‚æœå¯ç”¨äº†é˜²ç«å¢™ï¼‰

```bash
# å…è®¸HTTPæµé‡
sudo ufw allow 80/tcp

# å…è®¸HTTPSæµé‡ï¼ˆå¦‚æœé…ç½®SSLï¼‰
sudo ufw allow 443/tcp

# æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€
sudo ufw status
```

---

## ğŸ” ç¬¬å››éƒ¨åˆ†ï¼šSSLé…ç½®ï¼ˆHTTPSï¼‰

### æ­¥éª¤1: å‡†å¤‡SSLè¯ä¹¦

æ‚¨éœ€è¦ä»¥ä¸‹æ–‡ä»¶ï¼š
- `cert.crt` - è¯ä¹¦æ–‡ä»¶
- `cert.key` - ç§é’¥æ–‡ä»¶
- `chain.crt` - è¯ä¹¦é“¾æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

### æ­¥éª¤2: ä¸Šä¼ è¯ä¹¦åˆ°æœåŠ¡å™¨

```bash
# åˆ›å»ºè¯ä¹¦ç›®å½•
sudo mkdir -p /etc/ssl/aigctmp

# ä¸Šä¼ è¯ä¹¦æ–‡ä»¶ï¼ˆåœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œï¼‰
scp cert.crt lw@10.145.251.29:~/
scp cert.key lw@10.145.251.29:~/
scp chain.crt lw@10.145.251.29:~/

# ç§»åŠ¨åˆ°è¯ä¹¦ç›®å½•ï¼ˆåœ¨æœåŠ¡å™¨æ‰§è¡Œï¼‰
sudo mv ~/cert.crt /etc/ssl/aigctmp/
sudo mv ~/cert.key /etc/ssl/aigctmp/
sudo mv ~/chain.crt /etc/ssl/aigctmp/

# è®¾ç½®æƒé™
sudo chmod 600 /etc/ssl/aigctmp/cert.key
sudo chmod 644 /etc/ssl/aigctmp/cert.crt
sudo chmod 644 /etc/ssl/aigctmp/chain.crt
```

### æ­¥éª¤3: æ›´æ–°Apacheé…ç½®æ”¯æŒHTTPS

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
sudo nano /etc/apache2/sites-available/aigctmp.conf
```

**æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹**:
```apache
# HTTPSé…ç½®
<VirtualHost *:443>
    ServerName aigctmp.wzbc.edu.cn
    DocumentRoot /var/www/aigctmp

    # SSLé…ç½®
    SSLEngine on
    SSLCertificateFile /etc/ssl/aigctmp/cert.crt
    SSLCertificateKeyFile /etc/ssl/aigctmp/cert.key
    SSLCertificateChainFile /etc/ssl/aigctmp/chain.crt

    # å®‰å…¨å¤´
    Header always set Strict-Transport-Security "max-age=31536000"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"

    <Directory /var/www/aigctmp>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted

        # SPAè·¯ç”±æ”¯æŒ
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.html$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.html [L]
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/aigctmp_error.log
    CustomLog ${APACHE_LOG_DIR}/aigctmp_access.log combined
</VirtualHost>

# HTTPè‡ªåŠ¨è·³è½¬åˆ°HTTPS
<VirtualHost *:80>
    ServerName aigctmp.wzbc.edu.cn
    Redirect permanent / https://aigctmp.wzbc.edu.cn/
</VirtualHost>
```

### æ­¥éª¤4: å¯ç”¨SSLæ¨¡å—

```bash
# å¯ç”¨SSLæ¨¡å—
sudo a2enmod ssl

# å¯ç”¨headersæ¨¡å—
sudo a2enmod headers

# æµ‹è¯•é…ç½®
sudo apache2ctl configtest

# é‡å¯Apache
sudo systemctl restart apache2
```

---

## ğŸŒ ç¬¬äº”éƒ¨åˆ†ï¼šDNSé…ç½®

### è”ç³»ç½‘ç»œç®¡ç†å‘˜

éœ€è¦åœ¨DNSæœåŠ¡å™¨ä¸­æ·»åŠ Aè®°å½•ï¼š

**DNSè®°å½•ä¿¡æ¯**:
```
ç±»å‹: A
ä¸»æœºå: aigctmp
åŸŸå: wzbc.edu.cn
å®Œæ•´åŸŸå: aigctmp.wzbc.edu.cn
IPåœ°å€: 10.145.251.29
TTL: 3600ï¼ˆ1å°æ—¶ï¼‰
```

### ç­‰å¾…DNSç”Ÿæ•ˆ

DNSé…ç½®åéœ€è¦ç­‰å¾…ç”Ÿæ•ˆï¼ˆé€šå¸¸5åˆ†é’Ÿåˆ°2å°æ—¶ï¼‰

**æ£€æŸ¥DNSæ˜¯å¦ç”Ÿæ•ˆ**:
```bash
# æµ‹è¯•DNSè§£æ
ping aigctmp.wzbc.edu.cn

# åº”è¯¥æ˜¾ç¤º: 10.145.251.29
```

### ä¸´æ—¶æµ‹è¯•æ–¹æ³•ï¼ˆDNSæœªç”Ÿæ•ˆæ—¶ï¼‰

ä¿®æ”¹æœ¬åœ°hostsæ–‡ä»¶ï¼š

**Windows**:
```
1. ç”¨ç®¡ç†å‘˜æƒé™æ‰“å¼€è®°äº‹æœ¬
2. æ‰“å¼€æ–‡ä»¶: C:\Windows\System32\drivers\etc\hosts
3. æ·»åŠ : 10.145.251.29  aigctmp.wzbc.edu.cn
4. ä¿å­˜
```

**Linux/Mac**:
```bash
sudo nano /etc/hosts
# æ·»åŠ : 10.145.251.29  aigctmp.wzbc.edu.cn
```

---

## âœ… ç¬¬å…­éƒ¨åˆ†ï¼šæµ‹è¯•éªŒè¯

### 1. æµ‹è¯•DNSè§£æ

```bash
# æµ‹è¯•DNS
ping aigctmp.wzbc.edu.cn

# åº”è¯¥è¿”å›: 10.145.251.29
```

### 2. æµ‹è¯•HTTPè®¿é—®

```bash
# æµ‹è¯•HTTP
curl -I http://aigctmp.wzbc.edu.cn

# åº”è¯¥è¿”å›: HTTP/1.1 200 OK æˆ– 301 Moved Permanentlyï¼ˆå¦‚æœé…ç½®äº†HTTPSè·³è½¬ï¼‰
```

### 3. æµ‹è¯•HTTPSè®¿é—®ï¼ˆå¦‚æœé…ç½®äº†SSLï¼‰

```bash
# æµ‹è¯•HTTPS
curl -I https://aigctmp.wzbc.edu.cn

# åº”è¯¥è¿”å›: HTTP/1.1 200 OK
```

### 4. æµè§ˆå™¨æµ‹è¯•

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š
- HTTP: `http://aigctmp.wzbc.edu.cn`
- HTTPS: `https://aigctmp.wzbc.edu.cn`

**æ£€æŸ¥é¡¹ç›®**:
- [ ] é¦–é¡µè½®æ’­å›¾æ­£å¸¸æ˜¾ç¤º
- [ ] å¯¼èˆªæ æ­£å¸¸å·¥ä½œ
- [ ] ç‚¹å‡»"æ¯”èµ›è§„åˆ™"ç­‰é“¾æ¥ï¼Œé¡µé¢æ­£å¸¸è·³è½¬
- [ ] åˆ·æ–°é¡µé¢ä¸å‡ºç°404é”™è¯¯
- [ ] ç‚¹å‡»"ç™»å½•"æŒ‰é’®ï¼Œè·³è½¬åˆ°CASç™»å½•é¡µé¢
- [ ] æ‰€æœ‰å›¾ç‰‡å’Œæ ·å¼æ­£å¸¸åŠ è½½

### 5. æµ‹è¯•CASç™»å½•

1. ç‚¹å‡»"ç™»å½•"æŒ‰é’®
2. åº”è¯¥è·³è½¬åˆ°: `https://cas.wzbc.edu.cn/cas/oauth2.0/authorize?...`
3. è¾“å…¥å­¦å·å’Œå¯†ç 
4. ç™»å½•æˆåŠŸåï¼Œåº”è¯¥è·³è½¬å›ç½‘ç«™é¦–é¡µ
5. Headeråº”è¯¥æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯

### 6. æµ‹è¯•æ³¨é”€

1. ç‚¹å‡»"é€€å‡º"æŒ‰é’®
2. åº”è¯¥è·³è½¬åˆ°CASæ³¨é”€é¡µé¢
3. æ³¨é”€æˆåŠŸåï¼Œé‡å®šå‘å›é¦–é¡µ
4. ç”¨æˆ·ä¿¡æ¯åº”è¯¥æ¶ˆå¤±

---

## ğŸ”„ ç¬¬ä¸ƒéƒ¨åˆ†ï¼šæ›´æ–°éƒ¨ç½²æµç¨‹

å½“éœ€è¦æ›´æ–°ç½‘ç«™å†…å®¹æ—¶ï¼š

### æ–¹å¼1: æœ¬åœ°æ„å»ºåä¸Šä¼ ï¼ˆæ¨èï¼‰

```bash
# 1. åœ¨æœ¬åœ°ä¿®æ”¹ä»£ç 
# 2. é‡æ–°æ„å»º
cd ~/projects/app-7z58i603if41
npm run build

# 3. ä¸Šä¼ åˆ°æœåŠ¡å™¨
rsync -avz --delete dist/ lw@10.145.251.29:/var/www/aigctmp/

# 4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
# è®¿é—®ç½‘ç«™ï¼ŒæŒ‰ Ctrl+Shift+R å¼ºåˆ¶åˆ·æ–°
```

### æ–¹å¼2: æœåŠ¡å™¨ä¸Šç›´æ¥æ„å»º

```bash
# 1. è¿æ¥åˆ°æœåŠ¡å™¨
ssh lw@10.145.251.29

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/projects/app-7z58i603if41

# 3. æ‹‰å–æœ€æ–°ä»£ç ï¼ˆå¦‚æœä½¿ç”¨Gitï¼‰
git pull

# 4. é‡æ–°æ„å»º
npm run build

# 5. å¤åˆ¶åˆ°éƒ¨ç½²ç›®å½•
sudo cp -r dist/* /var/www/aigctmp/

# 6. é‡å¯Apacheï¼ˆå¯é€‰ï¼‰
sudo systemctl restart apache2
```

---

## ğŸ” ç¬¬å…«éƒ¨åˆ†ï¼šæ•…éšœæ’æŸ¥

### é—®é¢˜1: æ„å»ºå¤±è´¥

**ç—‡çŠ¶**:
```bash
npm run build
# æŠ¥é”™
```

**è§£å†³**:
```bash
# 1. åˆ é™¤ä¾èµ–é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install

# 2. æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version
# åº”è¯¥ >= 18.0.0

# 3. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
npm run build --verbose
```

### é—®é¢˜2: åŸŸåæ— æ³•è®¿é—®

**ç—‡çŠ¶**: æµè§ˆå™¨æ˜¾ç¤º"æ— æ³•è®¿é—®æ­¤ç½‘ç«™"

**æ’æŸ¥æ­¥éª¤**:
```bash
# 1. æ£€æŸ¥DNS
ping aigctmp.wzbc.edu.cn
# å¦‚æœå¤±è´¥ï¼ŒDNSæœªé…ç½®æˆ–æœªç”Ÿæ•ˆ

# 2. æ£€æŸ¥ApacheçŠ¶æ€
sudo systemctl status apache2
# å¦‚æœæœªè¿è¡Œï¼Œå¯åŠ¨å®ƒ
sudo systemctl start apache2

# 3. æ£€æŸ¥é˜²ç«å¢™
sudo ufw status
# ç¡®ä¿80å’Œ443ç«¯å£å¼€æ”¾

# 4. æ£€æŸ¥Apacheé…ç½®
sudo apache2ctl configtest

# 5. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/apache2/aigctmp_error.log
```

### é—®é¢˜3: æ˜¾ç¤ºApacheé»˜è®¤é¡µé¢

**ç—‡çŠ¶**: è®¿é—®åŸŸåæ˜¾ç¤º"Apache2 Ubuntu Default Page"

**è§£å†³**:
```bash
# 1. æ£€æŸ¥è™šæ‹Ÿä¸»æœºæ˜¯å¦å¯ç”¨
ls -l /etc/apache2/sites-enabled/ | grep aigctmp

# 2. å¦‚æœæ²¡æœ‰ï¼Œå¯ç”¨å®ƒ
sudo a2ensite aigctmp.conf
sudo systemctl restart apache2

# 3. æ£€æŸ¥DocumentRoot
cat /etc/apache2/sites-enabled/aigctmp.conf | grep DocumentRoot
# åº”è¯¥æ˜¯: /var/www/aigctmp

# 4. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la /var/www/aigctmp/
# åº”è¯¥æœ‰index.htmlç­‰æ–‡ä»¶
```

### é—®é¢˜4: é¡µé¢åˆ·æ–°å404é”™è¯¯

**ç—‡çŠ¶**: è®¿é—®é¦–é¡µæ­£å¸¸ï¼Œä½†åˆ·æ–°å…¶ä»–é¡µé¢æ˜¾ç¤º404

**è§£å†³**:
```bash
# 1. ç¡®ä¿rewriteæ¨¡å—å·²å¯ç”¨
sudo a2enmod rewrite
sudo systemctl restart apache2

# 2. æ£€æŸ¥.htaccessæ–‡ä»¶
ls -la /var/www/aigctmp/.htaccess

# 3. å¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»ºå®ƒ
sudo nano /var/www/aigctmp/.htaccess
```

`.htaccess` å†…å®¹ï¼š
```apache
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^index\.html$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
</IfModule>
```

### é—®é¢˜5: SSLè¯ä¹¦é”™è¯¯

**ç—‡çŠ¶**: æµè§ˆå™¨æ˜¾ç¤º"æ‚¨çš„è¿æ¥ä¸æ˜¯ç§å¯†è¿æ¥"

**è§£å†³**:
```bash
# 1. æ£€æŸ¥è¯ä¹¦æ–‡ä»¶
ls -la /etc/ssl/aigctmp/

# 2. æ£€æŸ¥è¯ä¹¦å†…å®¹
sudo openssl x509 -in /etc/ssl/aigctmp/cert.crt -text -noout

# 3. æ£€æŸ¥è¯ä¹¦åŸŸå
sudo openssl x509 -in /etc/ssl/aigctmp/cert.crt -noout -subject
# åº”è¯¥åŒ…å«: aigctmp.wzbc.edu.cn

# 4. æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸ
sudo openssl x509 -in /etc/ssl/aigctmp/cert.crt -noout -dates

# 5. æ£€æŸ¥Apache SSLé…ç½®
sudo apache2ctl -M | grep ssl
# åº”è¯¥æ˜¾ç¤º: ssl_module
```

### é—®é¢˜6: CASç™»å½•å¤±è´¥

**ç—‡çŠ¶**: ç‚¹å‡»ç™»å½•åæ— æ³•è·³è½¬æˆ–ç™»å½•åæ— æ³•å›è°ƒ

**è§£å†³**:
1. è”ç³»å­¦æ ¡ä¿¡æ¯ä¸­å¿ƒ
2. ç¡®è®¤å›è°ƒåœ°å€å·²æ³¨å†Œ: `https://aigctmp.wzbc.edu.cn/auth/callback`
3. ç¡®è®¤ä½¿ç”¨HTTPSåè®®ï¼ˆä¸æ˜¯HTTPï¼‰
4. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

---

## ğŸ“Š ç¬¬ä¹éƒ¨åˆ†ï¼šæ—¥å¸¸ç»´æŠ¤

### æŸ¥çœ‹è®¿é—®æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹è®¿é—®æ—¥å¿—
sudo tail -f /var/log/apache2/aigctmp_access.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/apache2/aigctmp_error.log

# æŸ¥çœ‹æœ€è¿‘100è¡Œæ—¥å¿—
sudo tail -n 100 /var/log/apache2/aigctmp_access.log
```

### é‡å¯Apache

```bash
# é‡å¯Apache
sudo systemctl restart apache2

# é‡æ–°åŠ è½½é…ç½®ï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰
sudo systemctl reload apache2

# æ£€æŸ¥çŠ¶æ€
sudo systemctl status apache2
```

### æ¸…ç†æ—¥å¿—

```bash
# æŸ¥çœ‹æ—¥å¿—å¤§å°
du -sh /var/log/apache2/

# æ¸…ç©ºæ—¥å¿—ï¼ˆè°¨æ…æ“ä½œï¼‰
sudo truncate -s 0 /var/log/apache2/aigctmp_access.log
sudo truncate -s 0 /var/log/apache2/aigctmp_error.log
```

### å¤‡ä»½ç½‘ç«™æ–‡ä»¶

```bash
# åˆ›å»ºå¤‡ä»½
sudo tar -czf /backup/aigctmp_$(date +%Y%m%d).tar.gz /var/www/aigctmp/

# æŸ¥çœ‹å¤‡ä»½
ls -lh /backup/

# æ¢å¤å¤‡ä»½
sudo tar -xzf /backup/aigctmp_20251203.tar.gz -C /
```

---

## ğŸ“‹ å®Œæ•´éƒ¨ç½²æ£€æŸ¥æ¸…å•

### æœ¬åœ°å‡†å¤‡
- [ ] Node.jså·²å®‰è£…ï¼ˆ>= 18.0.0ï¼‰
- [ ] é¡¹ç›®ä¾èµ–å·²å®‰è£…ï¼ˆnpm installï¼‰
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®ï¼ˆ.envï¼‰
- [ ] é¡¹ç›®æ„å»ºæˆåŠŸï¼ˆnpm run buildï¼‰
- [ ] distç›®å½•å·²ç”Ÿæˆ

### æœåŠ¡å™¨é…ç½®
- [ ] éƒ¨ç½²ç›®å½•å·²åˆ›å»ºï¼ˆ/var/www/aigctmpï¼‰
- [ ] æ–‡ä»¶å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] æ–‡ä»¶æƒé™å·²è®¾ç½®ï¼ˆ755/644ï¼‰
- [ ] Apacheå·²å®‰è£…
- [ ] è™šæ‹Ÿä¸»æœºé…ç½®å·²åˆ›å»º
- [ ] é…ç½®å·²å¯ç”¨ï¼ˆa2ensiteï¼‰
- [ ] rewriteæ¨¡å—å·²å¯ç”¨
- [ ] Apacheå·²é‡å¯

### DNSé…ç½®
- [ ] DNS Aè®°å½•å·²æ·»åŠ 
- [ ] DNSå·²ç”Ÿæ•ˆï¼ˆpingæµ‹è¯•ï¼‰
- [ ] è§£æåˆ°æ­£ç¡®IPï¼ˆ10.145.251.29ï¼‰

### SSLé…ç½®ï¼ˆå¯é€‰ï¼‰
- [ ] SSLè¯ä¹¦å·²å‡†å¤‡
- [ ] è¯ä¹¦å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] è¯ä¹¦æƒé™å·²è®¾ç½®
- [ ] Apache SSLé…ç½®å·²æ›´æ–°
- [ ] SSLæ¨¡å—å·²å¯ç”¨
- [ ] HTTPSè®¿é—®æ­£å¸¸

### åŠŸèƒ½æµ‹è¯•
- [ ] HTTPè®¿é—®æ­£å¸¸
- [ ] HTTPSè®¿é—®æ­£å¸¸ï¼ˆå¦‚æœé…ç½®ï¼‰
- [ ] é¦–é¡µæ­£å¸¸æ˜¾ç¤º
- [ ] æ‰€æœ‰é¡µé¢è·¯ç”±æ­£å¸¸
- [ ] é¡µé¢åˆ·æ–°ä¸å‡ºç°404
- [ ] CASç™»å½•æ­£å¸¸
- [ ] CASæ³¨é”€æ­£å¸¸
- [ ] é™æ€èµ„æºåŠ è½½æ­£å¸¸

---

## ğŸ¯ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# === æœ¬åœ°æ“ä½œ ===
# å®‰è£…ä¾èµ–
npm install

# æ„å»ºé¡¹ç›®
npm run build

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
rsync -avz --delete dist/ lw@10.145.251.29:/var/www/aigctmp/

# === æœåŠ¡å™¨æ“ä½œ ===
# è¿æ¥æœåŠ¡å™¨
ssh lw@10.145.251.29

# è®¾ç½®æƒé™
sudo chown -R www-data:www-data /var/www/aigctmp
sudo chmod -R 755 /var/www/aigctmp

# å¯ç”¨é…ç½®
sudo a2ensite aigctmp.conf
sudo a2enmod rewrite ssl headers

# é‡å¯Apache
sudo systemctl restart apache2

# æŸ¥çœ‹æ—¥å¿—
sudo tail -f /var/log/apache2/aigctmp_error.log

# === æµ‹è¯•å‘½ä»¤ ===
# æµ‹è¯•DNS
ping aigctmp.wzbc.edu.cn

# æµ‹è¯•HTTP
curl -I http://aigctmp.wzbc.edu.cn

# æµ‹è¯•HTTPS
curl -I https://aigctmp.wzbc.edu.cn
```

---

## ğŸ‰ éƒ¨ç½²å®Œæˆ

æ­å–œï¼å¦‚æœæ‰€æœ‰æ£€æŸ¥é¡¹éƒ½é€šè¿‡ï¼Œæ‚¨çš„ç½‘ç«™å·²ç»æˆåŠŸéƒ¨ç½²ï¼

**è®¿é—®åœ°å€**: https://aigctmp.wzbc.edu.cn

**ä¸‹ä¸€æ­¥**:
1. é€šçŸ¥ç”¨æˆ·å¯ä»¥è®¿é—®
2. æ”¶é›†ç”¨æˆ·åé¦ˆ
3. æ ¹æ®éœ€è¦è¿›è¡Œä¼˜åŒ–

---

**æ–‡æ¡£ç‰ˆæœ¬**: 2.0  
**æ›´æ–°æ—¥æœŸ**: 2025-12-03  
**é€‚ç”¨åœºæ™¯**: å®Œæ•´ç”Ÿäº§éƒ¨ç½²æµç¨‹
