# 🚀 智能体比赛报名平台 - 零基础部署指南

> 📌 **适合人群**: 完全没有编程基础的小白用户  
> ⏱️ **预计时间**: 30-60分钟  
> 💻 **部署位置**: 本地服务器（校园网内）

---

## 📖 目录

1. [项目介绍](#项目介绍)
2. [准备工作](#准备工作)
3. [方案选择](#方案选择)
4. [快速部署](#快速部署)
5. [测试验证](#测试验证)
6. [常见问题](#常见问题)

---

## 项目介绍

### 这是什么？

这是一个**智能体比赛报名网站**，学生可以通过学号登录，在线报名参加比赛。

### 主要功能

- ✅ **学号登录** - 使用温州商学院账号登录（CAS系统）
- ✅ **在线报名** - 填写报名信息，支持个人和团队
- ✅ **作品提交** - 上传参赛作品
- ✅ **状态查询** - 查看报名审核状态
- ✅ **管理后台** - 老师可以审核报名信息

### 技术说明（可跳过）

- **前端**: React网页应用
- **认证**: 温州商学院CAS系统（学校提供）
- **数据库**: Supabase（需要配置）
- **服务器**: Apache（学校服务器）

---

## 准备工作

### 需要的东西

#### 1. 硬件设备
- ✅ 一台电脑（Windows/Mac/Linux都可以）
- ✅ 能访问学校内网

#### 2. 软件工具
- ✅ **Node.js** - 用来运行和构建网站
- ✅ **代码编辑器** - 推荐VSCode（可选）
- ✅ **浏览器** - Chrome或Edge

#### 3. 账号权限
- ✅ 学校服务器访问权限
- ✅ 学校CAS系统管理权限（需要注册回调地址）
- ✅ Supabase账号（免费）

### 安装Node.js

#### Windows系统

1. 访问 https://nodejs.org/
2. 下载"LTS"版本（推荐版本）
3. 双击安装包，一路"下一步"
4. 安装完成后，打开"命令提示符"（CMD）
5. 输入 `node -v` 检查是否安装成功

```bash
node -v
# 应该显示: v18.x.x 或更高版本
```

#### Mac系统

1. 打开"终端"（Terminal）
2. 安装Homebrew（如果没有）:
```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```
3. 安装Node.js:
```bash
brew install node
```
4. 检查安装:
```bash
node -v
```

---

## 方案选择

### 🤔 我该选哪个方案？

项目使用了Supabase数据库，有两个部署方案：

| 方案 | 优点 | 缺点 | 推荐度 |
|------|------|------|--------|
| **方案A: 使用Supabase云服务** | ✅ 简单快速<br>✅ 免费额度够用<br>✅ 自动备份 | ⚠️ 需要联网<br>⚠️ 数据在云端 | ⭐⭐⭐⭐⭐ |
| **方案B: 完全本地部署** | ✅ 数据在本地<br>✅ 不依赖外网 | ❌ 配置复杂<br>❌ 需要技术支持 | ⭐⭐ |

### 💡 建议

**如果您是小白，强烈推荐方案A！**

原因：
1. Supabase虽然是云服务，但免费额度完全够用
2. 配置简单，10分钟搞定
3. 自动备份，不怕数据丢失
4. 学校内网可以正常访问

**如果必须完全本地化，请联系技术人员协助方案B**

---

## 快速部署

### 方案A: 使用Supabase云服务（推荐）

#### 第1步: 下载项目代码

```bash
# 1. 打开命令行（Windows: CMD, Mac: Terminal）

# 2. 进入你想放代码的文件夹
cd Desktop

# 3. 下载代码（如果有Git）
git clone <项目地址>

# 或者直接下载ZIP包解压
```

#### 第2步: 安装依赖

```bash
# 1. 进入项目文件夹
cd app-7z58i603if41

# 2. 安装依赖（需要等待几分钟）
npm install
```

**💡 提示**: 如果安装很慢，可以使用国内镜像：
```bash
npm config set registry https://registry.npmmirror.com
npm install
```

#### 第3步: 注册Supabase账号

1. 访问 https://supabase.com
2. 点击"Start your project"
3. 使用GitHub账号登录（或注册新账号）
4. 创建新项目：
   - Project name: `aigc-wzbc`（随便起名）
   - Database Password: 设置一个密码（记住它！）
   - Region: 选择"Northeast Asia (Tokyo)"（最近的服务器）
5. 等待项目创建（约2分钟）

#### 第4步: 获取Supabase配置

1. 项目创建完成后，点击左侧"Settings"（设置）
2. 点击"API"
3. 复制两个重要信息：
   - **Project URL** (类似: https://xxx.supabase.co)
   - **anon public** key (一长串字符)

#### 第5步: 配置环境变量

```bash
# 1. 复制环境变量模板
cp .env.example .env

# 2. 编辑.env文件（用记事本或VSCode打开）
# 填入刚才复制的信息
```

`.env` 文件内容：
```bash
VITE_SUPABASE_URL=https://你的项目ID.supabase.co
VITE_SUPABASE_ANON_KEY=你的anon_key
VITE_APP_ID=aigc_wzbc
VITE_API_ENV=production
```

#### 第6步: 创建数据库表

1. 回到Supabase网站
2. 点击左侧"SQL Editor"
3. 点击"New query"
4. 复制 `supabase/migrations/20250101000000_initial_schema.sql` 文件的内容
5. 粘贴到SQL编辑器
6. 点击"Run"执行

**💡 提示**: 如果有多个SQL文件，按顺序执行每一个

#### 第7步: 配置Supabase环境变量

1. 在Supabase网站，点击左侧"Edge Functions"
2. 点击"Manage secrets"
3. 添加以下环境变量：

```bash
OAUTH_TOKEN_URL=https://cas.wzbc.edu.cn/cas/oauth2.0/accessToken
OAUTH_USERINFO_URL=https://cas.wzbc.edu.cn/cas/oauth2.0/profile
OAUTH_CLIENT_ID=CijBwB5EwTTXouO7
OAUTH_CLIENT_SECRET=O8dOsXE7p7yMbh18KEP2Z6
OAUTH_REDIRECT_URI=https://aigc.wzbc.edu.cn/auth/callback
```

#### 第8步: 部署Edge Function

```bash
# 1. 安装Supabase CLI
npm install -g supabase

# 2. 登录Supabase
supabase login

# 3. 链接项目
supabase link --project-ref 你的项目ID

# 4. 部署函数
supabase functions deploy oauth-callback
```

**💡 提示**: 项目ID在Supabase网站的Settings → General中找到

#### 第9步: 本地测试

```bash
# 启动开发服务器
npm run dev
```

打开浏览器访问: http://localhost:5173

**测试内容**:
- ✅ 网站能正常打开
- ✅ 首页轮播图显示正常
- ✅ 点击"登录"跳转到CAS登录页面
- ✅ 登录后能看到用户信息

#### 第10步: 构建生产版本

```bash
# 构建网站
npm run build
```

构建完成后，会生成 `dist` 文件夹，里面是网站的所有文件。

#### 第11步: 部署到学校服务器

##### 方式1: 使用FTP工具（推荐小白）

1. 下载FileZilla（免费FTP工具）
2. 连接到学校服务器：
   - 主机: 服务器IP地址
   - 用户名: 你的用户名
   - 密码: 你的密码
3. 将 `dist` 文件夹里的所有文件上传到服务器的 `/var/www/html/` 目录

##### 方式2: 使用命令行

```bash
# 使用rsync上传（需要SSH权限）
rsync -avz --delete dist/ 用户名@服务器IP:/var/www/html/
```

#### 第12步: 配置Apache

联系服务器管理员，提供以下配置文件内容：

```apache
<VirtualHost *:443>
    ServerName aigc.wzbc.edu.cn
    DocumentRoot /var/www/html

    # SSL证书配置
    SSLEngine on
    SSLCertificateFile /path/to/cert.crt
    SSLCertificateKeyFile /path/to/cert.key
    SSLCertificateChainFile /path/to/chain.crt

    # 网站目录配置
    <Directory /var/www/html>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # 日志
    ErrorLog ${APACHE_LOG_DIR}/aigc_error.log
    CustomLog ${APACHE_LOG_DIR}/aigc_access.log combined
</VirtualHost>

# HTTP自动跳转HTTPS
<VirtualHost *:80>
    ServerName aigc.wzbc.edu.cn
    Redirect permanent / https://aigc.wzbc.edu.cn/
</VirtualHost>
```

#### 第13步: 注册CAS回调地址

联系学校信息中心，注册以下回调地址：

```
https://aigc.wzbc.edu.cn/auth/callback
```

---

### 方案B: 完全本地部署（高级）

⚠️ **警告**: 此方案需要较强的技术能力，建议找技术人员协助

#### 需要做的事情

1. **移除Supabase依赖**
   - 安装本地数据库（MySQL或PostgreSQL）
   - 重写所有数据库查询代码
   - 实现本地文件上传功能
   - 实现本地认证系统

2. **预计工作量**
   - 代码修改: 约50个文件
   - 测试时间: 2-3天
   - 技术难度: ⭐⭐⭐⭐⭐

3. **建议**
   - 如果必须本地化，建议使用Supabase自托管版本
   - 或者考虑使用其他本地化方案（如Strapi + SQLite）

**由于篇幅限制，详细步骤请联系技术支持**

---

## 测试验证

### 本地测试（开发环境）

```bash
# 1. 启动开发服务器
npm run dev

# 2. 打开浏览器访问
http://localhost:5173
```

#### 测试清单

- [ ] **首页测试**
  - [ ] 轮播图能正常显示和切换
  - [ ] 导航链接都能点击
  - [ ] 页面布局正常，没有错位

- [ ] **登录测试**
  - [ ] 点击"登录"按钮
  - [ ] 跳转到CAS登录页面
  - [ ] 输入学号密码
  - [ ] 登录成功后返回首页
  - [ ] Header显示用户名

- [ ] **报名测试**
  - [ ] 点击"立即报名"
  - [ ] 填写报名表单
  - [ ] 提交成功
  - [ ] 能在"我的报名"中看到

- [ ] **注销测试**
  - [ ] 点击"退出"按钮
  - [ ] 跳转到CAS注销页面
  - [ ] 返回首页后已登出

### 生产环境测试

```bash
# 访问生产网站
https://aigc.wzbc.edu.cn
```

#### 测试清单

- [ ] **HTTPS测试**
  - [ ] 浏览器地址栏显示🔒图标
  - [ ] 证书有效，没有警告

- [ ] **功能测试**
  - [ ] 所有本地测试的功能都正常
  - [ ] 图片加载速度正常
  - [ ] 没有404错误

- [ ] **性能测试**
  - [ ] 首页加载时间 < 3秒
  - [ ] 页面切换流畅
  - [ ] 移动端访问正常

---

## 常见问题

### Q1: npm install 很慢怎么办？

**A**: 使用国内镜像

```bash
# 设置淘宝镜像
npm config set registry https://registry.npmmirror.com

# 重新安装
npm install
```

### Q2: 启动后浏览器显示空白页？

**A**: 检查以下几点

1. 检查浏览器控制台（F12）是否有错误
2. 检查 `.env` 文件是否配置正确
3. 检查Supabase项目是否创建成功
4. 尝试清除浏览器缓存（Ctrl+Shift+Delete）

### Q3: 登录后跳转到空白页？

**A**: 检查OAuth配置

1. 确认CAS回调地址已注册
2. 检查Supabase环境变量是否配置
3. 检查Edge Function是否部署成功
4. 查看浏览器控制台的错误信息

### Q4: 上传文件失败？

**A**: 检查Supabase Storage

1. 在Supabase网站，点击"Storage"
2. 确认bucket已创建
3. 检查bucket权限设置
4. 确认文件大小 < 1MB

### Q5: 部署到服务器后404错误？

**A**: 检查Apache配置

1. 确认 `.htaccess` 文件已上传
2. 确认Apache已启用rewrite模块
3. 检查文件权限（755）
4. 查看Apache错误日志

### Q6: 我不想用Supabase，有其他方案吗？

**A**: 有以下几个选择

1. **Supabase自托管** - 在学校服务器上部署Supabase
   - 优点: 数据在本地，功能完整
   - 缺点: 需要Docker，配置复杂

2. **使用本地数据库** - 改用MySQL + PHP后端
   - 优点: 完全本地化
   - 缺点: 需要重写大量代码

3. **使用SQLite** - 轻量级本地数据库
   - 优点: 无需服务器，简单
   - 缺点: 功能有限，不支持多用户

**建议**: 如果必须本地化，推荐Supabase自托管方案

---

## 📞 需要帮助？

### 遇到问题怎么办？

1. **查看错误信息**
   - 打开浏览器控制台（F12）
   - 查看Console标签的错误
   - 截图保存

2. **检查日志**
   - Supabase日志: Dashboard → Logs
   - Apache日志: `/var/log/apache2/error.log`

3. **联系支持**
   - 技术支持: [联系方式]
   - 学校信息中心: [联系方式]

---

## ✅ 部署完成检查清单

### 开发环境

- [ ] Node.js已安装
- [ ] 项目代码已下载
- [ ] 依赖已安装（npm install）
- [ ] 环境变量已配置（.env）
- [ ] 本地能正常运行（npm run dev）
- [ ] 登录功能测试通过
- [ ] 报名功能测试通过

### Supabase配置

- [ ] Supabase账号已注册
- [ ] 项目已创建
- [ ] 数据库表已创建
- [ ] 环境变量已配置
- [ ] Edge Function已部署

### 生产环境

- [ ] 代码已构建（npm run build）
- [ ] 文件已上传到服务器
- [ ] Apache已配置
- [ ] SSL证书已安装
- [ ] CAS回调地址已注册
- [ ] HTTPS访问正常
- [ ] 所有功能测试通过

---

## 🎉 恭喜！

如果您完成了所有步骤，网站应该已经成功部署了！

**访问地址**: https://aigc.wzbc.edu.cn

**下一步**:
1. 通知学生可以开始报名
2. 定期检查报名数据
3. 及时审核报名信息

---

## 📚 附录

### 有用的命令

```bash
# 查看Node.js版本
node -v

# 查看npm版本
npm -v

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 代码检查
npm run lint

# 查看Supabase项目
supabase projects list

# 部署Edge Function
supabase functions deploy oauth-callback
```

### 有用的网址

- **Node.js官网**: https://nodejs.org/
- **Supabase官网**: https://supabase.com
- **项目文档**: 查看项目根目录的其他MD文件

### 文件说明

| 文件/文件夹 | 说明 |
|------------|------|
| `src/` | 源代码 |
| `public/` | 静态文件（图片等） |
| `dist/` | 构建输出（上传到服务器） |
| `.env` | 环境变量配置 |
| `package.json` | 项目依赖 |
| `supabase/` | Supabase配置 |

---

**文档版本**: 1.0  
**更新日期**: 2025-12-03  
**适用人群**: 零基础小白  
**预计时间**: 30-60分钟

**祝您部署顺利！🎉**
